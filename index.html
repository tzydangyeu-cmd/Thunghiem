<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>T·∫øt Nguy√™n ƒê√°n 2026 üßß</title>
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <style>
        html {
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        body {
            margin: 0;
            overflow: hidden;
            background: black;
            font-family: Arial, sans-serif;
        }

        #rotateScreen {
            position: fixed;
            inset: 0;
            background: black;
            color: white;
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        .rotate-box {
            font-size: 20px;
            text-align: center;
        }

        #startBtn {
            padding: 18px 40px;
            font-size: 22px;
            border: none;
            border-radius: 40px;
            background: linear-gradient(45deg, #ff5252, #ffb300);
            color: white;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(255, 200, 0, 0.8);
        }

        @font-face {
            font-family: "TetFont";
            src: url("https://raw.githubusercontent.com/ngotranhoangthinhhtk8c-cmd/Dip_tet_nguyen_dan/202e0674ff4858d19e9c4d18cee0314c30a7529d/SVN-Dancing-script.ttf") format("truetype");
            font-weight: normal;
            font-style: normal;
        }

        #rotateScreen {
            position: fixed;
            inset: 0;
            background: black;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        #phoneIcon {
            width: 100px;
            margin-bottom: 40px;
            opacity: 0;
            animation: phoneAnim 1.8s linear infinite;
            filter: drop-shadow(0 0 12px white);
        }

        .rotateText {
            font-family: "TetFont", cursive;
            font-size: 30px;
            color: white;
            text-align: center;
            text-shadow:
                0 0 5px #fff,
                0 0 15px #fff,
                0 0 30px rgba(255, 255, 255, 0.9);

            animation: glowText 2s ease-in-out infinite alternate;
        }

        @keyframes phoneAnim {
            0% {
                opacity: 0;
                transform: rotate(0deg);
            }

            20% {
                opacity: 1;
            }

            80% {
                opacity: 1;
                transform: rotate(-90deg);
            }

            100% {
                opacity: 0;
                transform: rotate(-90deg);
            }
        }

        @keyframes glowText {
            from {
                text-shadow:
                    0 0 5px #fff,
                    0 0 15px #fff;
            }

            to {
                text-shadow:
                    0 0 10px #fff,
                    0 0 25px #fff,
                    0 0 40px rgba(255, 255, 255, 1);
            }
        }

        #introScreen {
            position: fixed;
            inset: 0;
            background: black;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 20;
        }

        #introBox {
            padding: 40px 60px;
            border: 2px solid white;
            opacity: 0;
            box-shadow: 0 0 20px white;
            transition: opacity 1.5s ease;
            position: relative;
        }

        #introText {
            font-family: "TetFont", cursive;
            font-size: 38px;
            color: white;
            text-align: center;
            white-space: pre-line;
            text-shadow:
                0 0 5px #fff,
                0 0 15px #fff,
                0 0 30px rgba(255, 255, 255, 0.9);
        }

        #tapHint {
            position: absolute;
            bottom: -28px;
            right: 0;
            font-size: 14px;
            color: white;
            font-family: "TetFont", cursive;
            letter-spacing: 0.5px;
            text-decoration: underline;
            text-underline-offset: 4px;
        }

        #loadingScreen {
            position: fixed;
            inset: 0;
            background: black;
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 30;
        }

        .loadingText {
            font-family: "TetFont", cursive;
            font-size: 28px;
            color: white;
            text-shadow:
                0 0 5px #fff,
                0 0 15px #fff,
                0 0 30px rgba(255, 255, 255, 0.9);
            animation: glowText 2s ease-in-out infinite alternate;
        }

        .loadingBox {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 18px;
        }

        .progressBar {
            width: 280px;
            height: 8px;
            border: 1px solid white;
            box-shadow: 0 0 10px white;
            overflow: hidden;
        }

        .progressFill {
            width: 0%;
            height: 100%;
            background: white;
            box-shadow: 0 0 15px white;
            transition: width 0.3s ease;
        }

        .progressPercent {
            font-family: "TetFont", cursive;
            font-size: 18px;
            color: white;
        }
    </style>

</head>


<body style="text-align:center; background:#000; font-family:Arial;">

    <div id="rotateScreen">
        <img id="phoneIcon"
            src="https://raw.githubusercontent.com/ngotranhoangthinhhtk8c-cmd/Dip_tet_nguyen_dan/main/Anh_he_thong/phone.png"
            alt="Rotate phone" />
        <div class="rotateText">Vui l√≤ng xoay ngang m√†n h√¨nh</div>
    </div>

    <div id="introScreen">
        <div id="introBox">
            <div id="introText"></div>
            <div id="tapHint"></div>
        </div>
    </div>

    <div id="loadingScreen">
        <div class="loadingBox">
            <div class="loadingText">Loading...</div>

            <div class="progressBar">
                <div class="progressFill"></div>
            </div>

            <div class="progressPercent">0%</div>
        </div>
    </div>

    <canvas id="fireworks"></canvas>
    <script>
        const canvas = document.getElementById("fireworks");
        const ctx = canvas.getContext("2d");
        const rotateScreen = document.getElementById("rotateScreen");
        let started = false;
        let rockets = [];
        let particles = [];

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resize();
        window.addEventListener("resize", resize);

        function checkOrientation() {
            const isMobile = /Android|iPhone|iPad/i.test(navigator.userAgent);

            if (!isMobile) {
                rotateScreen.style.display = "none";
                startIntro(
                    introScreen.style.display = "flex"
                );
                return true;
            }

            if (window.innerHeight > window.innerWidth) {
                rotateScreen.style.display = "flex";
                return false;
            }

            rotateScreen.style.display = "none";
            startIntro();
            return true;
        }

        window.addEventListener("resize", checkOrientation);
        window.addEventListener("orientationchange", checkOrientation);

        class Rocket {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = canvas.height + 20;

                this.vy = -(12 + Math.random() * 4);
                this.gravity = 0.15;

                this.vx = (Math.random() - 0.5) * 1.2;
                this.wave = Math.random() * 0.1;

                this.color = `hsl(${Math.random() * 360},100%,65%)`;

                this.stop = false;
                this.wait = 0;
            }

            update() {
                if (!this.stop) {
                    this.vy += this.gravity;

                    if (this.vy >= 0) {
                        this.vy = 0;
                        this.stop = true;
                    }

                    this.y += this.vy;
                    this.x += this.vx + Math.sin(this.y * this.wave);
                } else {
                    this.wait++;
                    if (this.wait > 60) {
                        this.explode();
                        return false;
                    }
                }
                return true;
            }

            draw() {
                if (this.stop) return;
                ctx.save();
                ctx.shadowBlur = 20;
                ctx.shadowColor = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, 2.5, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.restore();
            }
            explode() {
                playBoom();
                for (let i = 0; i < 100; i++) {
                    particles.push(new Particle(this.x, this.y, this.color));
                }
            }
        }
        class Particle {
            constructor(x, y, color) {
                this.x = x;
                this.y = y;
                this.color = color;
                const angle = Math.random() * Math.PI * 2;
                const speed = Math.random() * 6 + 4;
                this.vx = Math.cos(angle) * speed;
                this.vy = Math.sin(angle) * speed;
                this.life = 120;
                this.size = Math.random() * 2 + 1;
            }

            update() {
                this.vx *= 0.97;
                this.vy *= 0.97;
                this.x += this.vx;
                this.y += this.vy;
                this.life--;
                return this.life > 0;
            }

            draw() {
                ctx.save();
                ctx.globalAlpha = this.life / 120;
                ctx.shadowBlur = 30 + Math.random() * 10;
                ctx.shadowColor = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.restore();
            }
        }

        function animate() {
            if (!started) return;
            ctx.fillStyle = "rgba(0,0,0,0.25)";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            if (Math.random() < 0.04) {
                rockets.push(new Rocket());
            }

            rockets = rockets.filter(r => {
                r.draw();
                return r.update();
            });

            particles = particles.filter(p => {
                p.draw();
                return p.update();
            });

            requestAnimationFrame(animate);
        }

        checkOrientation();
    </script>
    <script>
        function enterFullscreen() {
            const el = document.documentElement;
            if (el.requestFullscreen) {
                el.requestFullscreen();
            } else if (el.webkitRequestFullscreen) {
                el.webkitRequestFullscreen(); // Safari
            }
        }
    </script>

    <script>
        let audioCtx;
        let boomBuffer;
        let bgBuffer;
        let bgSource;

        async function initAudio() {
    try {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        if (audioCtx.state === "suspended") {
            await audioCtx.resume();
        }

        // ===== DANH S√ÅCH FILE √ÇM THANH =====
        const files = [
            { name: "boom", url: "audio/boom.mp3" },
            { name: "bg", url: "audio/bg.mp3" }
        ];

        let totalBytes = 0;
        let loadedBytes = 0;

        // ===== L·∫§Y T·ªîNG DUNG L∆Ø·ª¢NG =====
        for (const file of files) {
            const res = await fetch(file.url, { method: "HEAD" });
            const size = res.headers.get("Content-Length");
            totalBytes += Number(size);
        }

        function updateProgress() {
            const percent = Math.min(
                100,
                Math.floor((loadedBytes / totalBytes) * 100)
            );
            progressFill.style.width = percent + "%";
            progressPercent.textContent = percent + "%";
        }

        // ===== LOAD T·ª™NG FILE =====
        for (const file of files) {
            const response = await fetch(file.url);
            const reader = response.body.getReader();
            let chunks = [];
            let received = 0;

            while (true) {
                const { done, value } = await reader.read();
                if (done) break;

                chunks.push(value);
                received += value.length;
                loadedBytes += value.length;
                updateProgress();
            }

            const audioBuffer = await audioCtx.decodeAudioData(
                mergeChunks(chunks, received)
            );

            if (file.name === "boom") boomBuffer = audioBuffer;
            if (file.name === "bg") bgBuffer = audioBuffer;
        }

        updateProgress(); // ƒë·∫£m b·∫£o 100%
        console.log("All audio loaded with real progress");

    } catch (err) {
        console.error("Audio load error:", err);
        alert("Kh√¥ng t·∫£i ƒë∆∞·ª£c √¢m thanh üò•");
    }
        }

        function mergeChunks(chunks, totalLength) {
    const buffer = new Uint8Array(totalLength);
    let offset = 0;

    for (const chunk of chunks) {
        buffer.set(chunk, offset);
        offset += chunk.length;
    }

    return buffer.buffer;
        }

        function playBG() {
            if (!bgBuffer || !audioCtx) return;
            bgSource = audioCtx.createBufferSource();
            bgSource.buffer = bgBuffer;
            bgSource.loop = true;
            const gainNode = audioCtx.createGain();
            gainNode.gain.value = 0.4; // volume √¢m thanh n·ªÅn
            bgSource.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            bgSource.start(0);
        }

        function playBoom() {
            if (!boomBuffer || !audioCtx) return;
            const source = audioCtx.createBufferSource();
            source.buffer = boomBuffer;
            source.connect(audioCtx.destination);
            source.start(0);
        }
    </script>

    <script>
        const progressFill = document.querySelector(".progressFill");
        const progressPercent = document.querySelector(".progressPercent");
        const loadingScreen = document.getElementById("loadingScreen");
        const introScreen = document.getElementById("introScreen");
        const introBox = document.getElementById("introBox");
        const introText = document.getElementById("introText");
        const tapHint = document.getElementById("tapHint");
        const mainText = "H√£y qu√™n ƒëi mu·ªôn phi·ªÅn nƒÉm c≈©\nC√πng nhau ƒë√≥n T·∫øt th√¥i n√†o";
        const hintText = "nh·∫•n v√†o m√†n h√¨nh";
        const music = new Audio("https://raw.githubusercontent.com/tzydangyeu-cmd/Nam_moi_cho_em/main/sounds/bg.mp3");
        let textIndex = 0;
        let hintIndex = 0;
        let introDone = false;

        function typeMainText() {
            if (textIndex < mainText.length) {
                introText.textContent += mainText.charAt(textIndex);
                textIndex++;
                setTimeout(typeMainText, 60);
            } else {
                setTimeout(typeHintText, 500);
            }
        }

        function typeHintText() {
            if (hintIndex < hintText.length) {
                tapHint.textContent += hintText.charAt(hintIndex);
                hintIndex++;
                setTimeout(typeHintText, 80);
            } else {
                introDone = true;
            }
        }

        let introStarted = false;

        function startIntro() {
            if (introStarted) return;
            introStarted = true;
            introScreen.style.display = "flex";
            introText.textContent = "";
            tapHint.textContent = "";
            introBox.style.opacity = 1;
            setTimeout(typeMainText, 800);
        }

        introScreen.addEventListener("click", async () => {
            if (!introDone) return;
            enterFullscreen();
            introScreen.style.transition = "opacity 1.5s ease";
            introScreen.style.opacity = 0;
            setTimeout(async () => {
                introScreen.remove();
                loadingScreen.style.display = "flex";
                await initAudio();
                setTimeout(() => {
                    loadingScreen.style.opacity = 0;
                    setTimeout(() => {
                        loadingScreen.remove();
                        playBG();
                        started = true;
                        animate();
                    }, 1000);
                }, 2000);
            }, 1500);
        });

    </script>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const isMobile = /Android|iPhone|iPad/i.test(navigator.userAgent);
            if (!isMobile) {
                console.log("PC detected ‚Üí start intro");
                startIntro();
            }
        });
    </script>

</body>

</html>
