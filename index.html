<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>T·∫øt Nguy√™n ƒê√°n 2026 üßß</title>
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <style>
        html {
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        :root {
            /* c√†nh mai ph·∫£i */
            --mai-size: 60vw;
            --mai-max: 5000px;
            --mai-offset-x: 5px;
            --mai-offset-y: -20px;

            /* c√†nh mai tr√°i */
            --mai-left-size: 40vw;
            --mai-left-max: 5000px;
            --mai-left-offset-x: -5px;
            --mai-left-offset-y: -15px;

            /* t·∫øt */
            --tet-size: 50vw;
            --tet-max: 5000px;
            --tet-offset-x: 0px;
            --tet-offset-y: 0px;

            /* 2026 */
            --haisau-size: 20vw;
            --haisau-max: 5000px;
            --haisau-offset-x: 0px;
            --haisau-offset-y: 150px;

            /* g√≥c tr√°i d∆∞·ªõi*/
            --gtd-size: 110vw;
            --gtd-max: 5000px;
            --gtd-offset-x: -5px;
            --gtd-offset-y: -5px;

            /* g√≥c ph·∫£i d∆∞·ªõi*/
            --dao-size: 25vw;
            --dao-max: 5000px;
            --dao-offset-x: 5px;
            --dao-offset-y: 5px;

            /* b√† v√† c√°c ch√°u */
            --bvcc-size: 100vw;
            --bvcc-max: 5000px;
            --bvcc-offset-x: 0px;
            --bvcc-offset-y: 0px;

            /* l√¢n */
            --lan-size: 80vw;
            --lan-max: 5000px;
            --lan-offset-x: 0px;
            --lan-offset-y: 0px;

            /* üßß t·ªâ l·ªá thi·ªáp */
            --card-width: 50vw;
            --card-max-width: 5000px;
            --card-ratio: 3 / 4;

            /* ‚úçÔ∏è gi·ªõi h·∫°n l·ªùi ch√∫c (% theo thi·ªáp) */
            --text-top: 38%;
            --text-bottom: 35%;
            --text-left: 24%;
            --text-right: 28%;
        }

        body {
            margin: 0;
            overflow: hidden;
            background: black;
            font-family: Arial, sans-serif;
            text-align: center;
            transition: background 2.5s ease;
        }

        #rotateScreen {
            position: fixed;
            inset: 0;
            background: black;
            color: white;
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        .rotate-box {
            font-size: 20px;
            text-align: center;
        }

        #startBtn {
            padding: 18px 40px;
            font-size: 22px;
            border: none;
            border-radius: 40px;
            background: linear-gradient(45deg, #ff5252, #ffb300);
            color: white;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(255, 200, 0, 0.8);
        }

        @font-face {
            font-family: "TetFont";
            src: url("https://raw.githubusercontent.com/ngotranhoangthinhhtk8c-cmd/Dip_tet_nguyen_dan/202e0674ff4858d19e9c4d18cee0314c30a7529d/SVN-Dancing-script.ttf") format("truetype");
            font-weight: normal;
            font-style: normal;
        }

        #rotateScreen {
            position: fixed;
            inset: 0;
            background: black;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        #phoneIcon {
            width: 100px;
            margin-bottom: 40px;
            opacity: 0;
            animation: phoneAnim 1.8s linear infinite;
            filter: drop-shadow(0 0 12px white);
        }

        .rotateText {
            font-family: "TetFont", cursive;
            font-size: 30px;
            color: white;
            text-align: center;
            text-shadow:
                0 0 5px #fff,
                0 0 15px #fff,
                0 0 30px rgba(255, 255, 255, 0.9);

            animation: glowText 2s ease-in-out infinite alternate;
        }

        @keyframes phoneAnim {
            0% {
                opacity: 0;
                transform: rotate(0deg);
            }

            20% {
                opacity: 1;
            }

            80% {
                opacity: 1;
                transform: rotate(-90deg);
            }

            100% {
                opacity: 0;
                transform: rotate(-90deg);
            }
        }

        @keyframes glowText {
            from {
                text-shadow:
                    0 0 5px #fff,
                    0 0 15px #fff;
            }

            to {
                text-shadow:
                    0 0 10px #fff,
                    0 0 25px #fff,
                    0 0 40px rgba(255, 255, 255, 1);
            }
        }

        @keyframes swayBranch {
            0% {
                transform: rotate(0deg);
            }

            25% {
                transform: rotate(0.8deg);
            }

            50% {
                transform: rotate(0deg);
            }

            75% {
                transform: rotate(-0.8deg);
            }

            100% {
                transform: rotate(0deg);
            }
        }

        @keyframes floatText {
            0% {
                transform: translate(0, 0);
            }

            25% {
                transform: translate(2px, -3px);
            }

            50% {
                transform: translate(0, -1px);
            }

            75% {
                transform: translate(-2px, -3px);
            }

            100% {
                transform: translate(0, 0);
            }
        }

        #introScreen {
            position: fixed;
            inset: 0;
            background: black;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 20;
        }

        #introBox {
            padding: 40px 60px;
            border: 2px solid white;
            opacity: 0;
            box-shadow: 0 0 20px white;
            transition: opacity 1.5s ease;
            position: relative;
        }

        #introText {
            font-family: "TetFont", cursive;
            font-size: 38px;
            color: white;
            text-align: center;
            white-space: pre-line;
            text-shadow:
                0 0 5px #fff,
                0 0 15px #fff,
                0 0 30px rgba(255, 255, 255, 0.9);
        }

        #tapHint {
            position: absolute;
            bottom: -28px;
            right: 0;
            font-size: 14px;
            color: white;
            font-family: "TetFont", cursive;
            letter-spacing: 0.5px;
            text-decoration: underline;
            text-underline-offset: 4px;
        }

        #loadingScreen {
            position: fixed;
            inset: 0;
            background: black;
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 30;
        }

        .loadingText {
            font-family: "TetFont", cursive;
            font-size: 28px;
            color: white;
            text-shadow:
                0 0 5px #fff,
                0 0 15px #fff,
                0 0 30px rgba(255, 255, 255, 0.9);
            animation: glowText 2s ease-in-out infinite alternate;
        }

        .loadingBox {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 18px;
        }

        .progressBar {
            width: 280px;
            height: 8px;
            border: 1px solid white;
            box-shadow: 0 0 10px white;
            overflow: hidden;
        }

        .progressFill {
            width: 0%;
            height: 100%;
            background: white;
            box-shadow: 0 0 15px white;
            transition: width 0.3s ease;
        }

        .progressPercent {
            font-family: "TetFont", cursive;
            font-size: 18px;
            color: white;
        }

        #loadingScreen {
            transition: opacity 1.2s ease;
        }

        #fullscreenBtn {
            position: fixed;
            top: 12px;
            right: 12px;
            z-index: 99999;

            width: 30px;
            height: 30px;

            font-size: 20px;
            line-height: 1;

            display: flex;
            align-items: center;
            justify-content: center;

            color: black;
            background: rgba(0, 0, 0, 0);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;

            cursor: pointer;
            backdrop-filter: blur(6px);
        }

        #fullscreenBtn:active {
            transform: scale(0.95);
        }

        #mai-anchor {
            position: fixed;
            top: 0;
            right: 0;

            transform: translate(var(--mai-offset-x), var(--mai-offset-y));
            pointer-events: none;
            z-index: 2;
        }

        #mai-branch {
            width: clamp(180px, var(--mai-size), var(--mai-max));
            aspect-ratio: 1 / 1;

            background-image: url("https://raw.githubusercontent.com/ngotranhoangthinhhtk8c-cmd/Dip_tet_nguyen_dan/main/Anh_he_thong/canh_cay_phai.png");
            background-repeat: no-repeat;
            background-size: contain;
            background-position: top right;

            transform-origin: top right;

            opacity: 0;
            transform: translateX(120px);

            transition:
                opacity 2s ease,
                transform 2s ease;
        }

        #mai-left-anchor {
            position: fixed;
            top: 0;
            left: 0;

            transform: translate(var(--mai-left-offset-x),
                    var(--mai-left-offset-y));

            pointer-events: none;
            z-index: 2;
        }

        #mai-left-branch {
            width: clamp(180px, var(--mai-left-size), var(--mai-left-max));
            aspect-ratio: 1 / 1;

            background-image: url("https://raw.githubusercontent.com/ngotranhoangthinhhtk8c-cmd/Dip_tet_nguyen_dan/main/Anh_he_thong/canh_cay_trai.png");
            background-repeat: no-repeat;
            background-size: contain;
            background-position: top left;

            transform-origin: top left;

            opacity: 0;
            transform: translateX(-120px);

            transition:
                opacity 2s ease,
                transform 2s ease;
        }

        #tet-text-anchor {
            position: fixed;
            top: 50%;
            left: 50%;

            transform: translate(calc(-50% + var(--tet-offset-x)),
                    calc(-50% + var(--tet-offset-y)));

            pointer-events: none;
            z-index: 3;
        }

        #haisau-text-anchor {
            position: fixed;
            top: 50%;
            left: 50%;

            transform: translate(calc(-50% + var(--haisau-offset-x)),
                    calc(-50% + var(--haisau-offset-y)));

            pointer-events: none;
            z-index: 3;
        }

        #tet-text {
            width: clamp(180px, var(--tet-size), var(--tet-max));
            aspect-ratio: 3 / 1;
            /* ch·ªânh n·∫øu ·∫£nh kh√°c */

            background-image: url("https://raw.githubusercontent.com/ngotranhoangthinhhtk8c-cmd/Dip_tet_nguyen_dan/main/Anh_he_thong/tet.png");
            background-repeat: no-repeat;
            background-size: contain;
            background-position: center;

            opacity: 0;
            transform: scale(0.95);

            transition:
                opacity 2s ease,
                transform 2s ease;
        }

        #haisau-text {
            width: clamp(180px, var(--haisau-size), var(--haisau-max));
            aspect-ratio: 1 / 1;
            /* ch·ªânh n·∫øu ·∫£nh kh√°c */

            background-image: url("https://raw.githubusercontent.com/ngotranhoangthinhhtk8c-cmd/Dip_tet_nguyen_dan/main/Anh_he_thong/haisau.png");
            background-repeat: no-repeat;
            background-size: contain;
            background-position: center;

            opacity: 0;
            transform: scale(0.95);

            transition:
                opacity 2s ease,
                transform 2s ease;
        }

        #gtd-anchor {
            position: fixed;
            left: 0;
            bottom: 0;

            transform: translate(var(--gtd-offset-x),
                    calc(-1 * var(--gtd-offset-y)));

            pointer-events: none;
            z-index: 3;
        }

        #gtd {
            width: clamp(180px, var(--gtd-size), var(--gtd-max));
            aspect-ratio: 5 / 1;
            /* ch·ªânh n·∫øu ·∫£nh kh√°c */

            background-image: url("https://raw.githubusercontent.com/ngotranhoangthinhhtk8c-cmd/Dip_tet_nguyen_dan/main/Anh_he_thong/goc_trai_duoi.png");
            background-repeat: no-repeat;
            background-size: contain;
            background-position: bottom left;
            transform-origin: bottom left;

            opacity: 0;
            transform: translateX(-120px);

            transition:
                opacity 2s ease,
                transform 2s ease;
        }

        #dao-anchor {
            position: fixed;
            right: 0;
            bottom: 0;

            transform: translate(var(--dao-offset-x),
                    var(--dao-offset-y));

            pointer-events: none;
            z-index: 2;
        }

        #dao-branch {
            width: clamp(180px, var(--dao-size), var(--dao-max));
            aspect-ratio: 1 / 1;

            background-image: url("https://raw.githubusercontent.com/ngotranhoangthinhhtk8c-cmd/Dip_tet_nguyen_dan/main/Anh_he_thong/goc_phai_duoi.png");
            background-repeat: no-repeat;
            background-size: contain;
            background-position: bottom right;

            transform-origin: bottom right;

            opacity: 0;
            transform: translateX(120px);

            transition:
                opacity 2s ease,
                transform 2s ease;
        }

        #bvcc-anchor {
            position: fixed;
            top: 70%;
            left: 23%;

            transform: translate(calc(-50% + var(--bvcc-offset-x)),
                    calc(-55% + var(--bvcc-offset-y)));

            pointer-events: none;
            z-index: 3;
        }

        #bvcc {
            width: clamp(180px, var(--bvcc-size), var(--bvcc-max));
            aspect-ratio: 6 / 1;
            /* ch·ªânh n·∫øu ·∫£nh kh√°c */

            background-image: url("https://raw.githubusercontent.com/ngotranhoangthinhhtk8c-cmd/Dip_tet_nguyen_dan/main/Anh_he_thong/bvcc.png");
            background-repeat: no-repeat;
            background-size: contain;
            background-position: center;

            opacity: 0;
            transform: scale(0.95);

            transition:
                opacity 2s ease,
                transform 2s ease;
        }

        #lan-anchor {
            position: fixed;
            top: 60%;
            left: 70%;

            transform: translate(calc(-50% + var(--lan-offset-x)),
                    calc(-50% + var(--lan-offset-y)));

            pointer-events: none;
            z-index: 3;
        }

        #lan {
            width: clamp(180px, var(--lan-size), var(--lan-max));
            aspect-ratio: 3 / 1;
            /* ch·ªânh n·∫øu ·∫£nh kh√°c */

            background-image: url("https://raw.githubusercontent.com/ngotranhoangthinhhtk8c-cmd/Dip_tet_nguyen_dan/main/Anh_he_thong/lan.png");
            background-repeat: no-repeat;
            background-size: contain;
            background-position: center;

            opacity: 0;
            transform: scale(0.95);

            transition:
                opacity 2s ease,
                transform 2s ease;
        }

        .leaf {
            position: fixed;
            top: -60px;

            background-size: contain;
            background-repeat: no-repeat;
            pointer-events: none;

            z-index: 1;
            opacity: 0.9;
        }

        #card-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.45);

            opacity: 0;
            pointer-events: none;

            transition: opacity 1.2s ease;
            z-index: 10;
        }


        #card-anchor {
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -40%);
            transition: opacity 1s ease, transform 1s ease;
            opacity: 0;
            z-index: 999;
        }

        #card {
            width: clamp(260px, var(--card-width), var(--card-max-width));
            aspect-ratio: var(--card-ratio);

            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;

            position: relative;
            opacity: 0;
            transform: translateY(20px);
            transition:
                opacity 1.2s ease,
                transform 1.2s ease;
        }

        #card-text-box {
            position: absolute;
            top: var(--text-top);
            bottom: var(--text-bottom);
            left: var(--text-left);
            right: var(--text-right);

            overflow-y: auto;
            /* ‚úÖ cho cu·ªôn d·ªçc */
            overflow-x: hidden;

            scrollbar-width: none;
            /* Firefox */
            -ms-overflow-style: none;
            /* IE, Edge c≈© */
        }

        #card-text-box::-webkit-scrollbar {
            display: none;
        }

        #card-text {
            font-family: "TetFont", "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", cursive;
            /* ‚úÖ font iro */
            font-size: 1rem;
            line-height: 1.6;
            color: #5a2a0c;
            white-space: pre-wrap;
        }

        #card-close {
            position: absolute;
            top: 24%;
            /* ‚¨Ö c√°ch m√©p tr√™n */
            right: 0;
            /* ‚¨Ö c√°ch m√©p ph·∫£i */
            transform: translate(-12px, 12px);

            width: 36px;
            /* ‚¨Ö vu√¥ng l·ªõn h∆°n ch·ªØ X */
            height: 36px;

            display: flex;
            align-items: center;
            justify-content: center;

            background: #ffd2c2;
            /* üé® n·ªÅn */
            border: 5px solid #761413;
            /* üé® vi·ªÅn */
            border-radius: 8px;
            /* bo g√≥c m·ªÅm */

            color: #761413;
            font-size: 20px;
            font-weight: bold;

            cursor: pointer;
            z-index: 10;

            transition: transform 0.2s ease, background 0.2s ease;
        }

        #card-close:hover {
            background: #ffbeab;
            transform: translate(-12px, 12px) scale(1.08);
        }

        /* üîÅ n√∫t m·ªü l·∫°i thi·ªáp */
        #reopen-card-btn {
            position: fixed;
            top: 16px;
            left: 16px;

            opacity: 0;
            pointer-events: none;

            transition: opacity 0.8s ease;
            z-index: 1000;
        }

        #reopen-card-btn img {
            width: 48px;
            /* ‚≠ê ch·ªânh k√≠ch th∆∞·ªõc icon t·∫°i ƒë√¢y */
            height: auto;
            cursor: pointer;
            filter: drop-shadow(0 0 6px rgba(0, 0, 0, 0.3));
        }

        #reopen-card-btn.show {
            opacity: 1;
            pointer-events: auto;
        }
    </style>

</head>


<body>

    <div id="lan-anchor">
        <div id="lan"></div>
    </div>

    <div id="bvcc-anchor">
        <div id="bvcc"></div>
    </div>

    <div id="dao-anchor">
        <div id="dao-branch"></div>
    </div>

    <div id="gtd-anchor">
        <div id="gtd"></div>
    </div>

    <div id="tet-text-anchor">
        <div id="tet-text"></div>
    </div>

    <div id="haisau-text-anchor">
        <div id="haisau-text"></div>
    </div>

    <div id="mai-anchor">
        <div id="mai-branch"></div>
    </div>

    <div id="mai-left-anchor">
        <div id="mai-left-branch"></div>
    </div>

    <div id="rotateScreen">
        <img id="phoneIcon"
            src="https://raw.githubusercontent.com/ngotranhoangthinhhtk8c-cmd/Dip_tet_nguyen_dan/main/Anh_he_thong/phone.png"
            alt="Rotate phone" />
        <div class="rotateText">Vui l√≤ng xoay ngang m√†n h√¨nh</div>
    </div>

    <div id="introScreen">
        <div id="introBox">
            <div id="introText"></div>
            <div id="tapHint"></div>
        </div>
    </div>

    <div id="loadingScreen">
        <div class="loadingBox">
            <div class="loadingText">Loading...</div>

            <div class="progressBar">
                <div class="progressFill"></div>
            </div>

            <div class="progressPercent">0%</div>
        </div>
    </div>

    <canvas id="fireworks"></canvas>
    <script>
        const canvas = document.getElementById("fireworks");
        const ctx = canvas.getContext("2d");
        const rotateScreen = document.getElementById("rotateScreen");
        let started = false;

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resize();
        window.addEventListener("resize", resize);

        function checkOrientation() {
            const isMobile = /Android|iPhone|iPad/i.test(navigator.userAgent);

            if (!isMobile) {
                rotateScreen.style.display = "none";
                startIntro();
                return true;
            }

            if (window.innerHeight > window.innerWidth) {
                rotateScreen.style.display = "flex";
                return false;
            }

            rotateScreen.style.display = "none";
            startIntro();
            return true;
        }

        window.addEventListener("resize", checkOrientation);
        window.addEventListener("orientationchange", checkOrientation);

        checkOrientation();
    </script>
    <script>
        function enterFullscreen() {
            const el = document.documentElement;
            if (el.requestFullscreen) {
                el.requestFullscreen();
            } else if (el.webkitRequestFullscreen) {
                el.webkitRequestFullscreen(); // Safari
            }
        }
    </script>

    <script>
        let audioCtx;
        let bgBuffer;
        let bgSource;

        async function initAudio() {
            try {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();

                if (audioCtx.state === "suspended") {
                    await audioCtx.resume();
                }

                const files = [

                    { name: "bg", url: "audio/bg.mp3" },
                ];

                let totalBytes = 0;
                let loadedBytes = 0;

                for (const file of files) {
                    const res = await fetch(file.url, { method: "HEAD" });
                    const size = res.headers.get("Content-Length");
                    totalBytes += Number(size);
                }

                function updateProgress() {
                    const percent = Math.min(
                        100,
                        Math.floor((loadedBytes / totalBytes) * 100)
                    );
                    progressFill.style.width = percent + "%";
                    progressPercent.textContent = percent + "%";
                }

                for (const file of files) {
                    const response = await fetch(file.url);
                    const reader = response.body.getReader();
                    let chunks = [];
                    let received = 0;

                    while (true) {
                        const { done, value } = await reader.read();
                        if (done) break;
                        chunks.push(value);
                        received += value.length;
                        loadedBytes += value.length;
                        updateProgress();
                    }

                    const audioBuffer = await audioCtx.decodeAudioData(
                        mergeChunks(chunks, received)
                    );
                    if (file.name === "bg") bgBuffer = audioBuffer;
                }

                updateProgress();
                console.log("All audio loaded with real progress");

            } catch (err) {
                console.error("Audio load error:", err);
                alert("Kh√¥ng t·∫£i ƒë∆∞·ª£c √¢m thanh üò•");
            }
        }

        function mergeChunks(chunks, totalLength) {
            const buffer = new Uint8Array(totalLength);
            let offset = 0;

            for (const chunk of chunks) {
                buffer.set(chunk, offset);
                offset += chunk.length;
            }

            return buffer.buffer;
        }

        function playBG() {
            if (!bgBuffer || !audioCtx) return;
            bgSource = audioCtx.createBufferSource();
            bgSource.buffer = bgBuffer;
            bgSource.loop = true;
            const gainNode = audioCtx.createGain();
            gainNode.gain.value = 0.4; // volume √¢m thanh n·ªÅn
            bgSource.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            bgSource.start(0);
        }

        const LEAF_CONFIG = {
            maxLeaves: 60,        // üçÉ s·ªë l√° t·ªëi ƒëa tr√™n m√†n h√¨nh
            fallSpeed: 1,         // ‚è±Ô∏è t·ªëc ƒë·ªô r∆°i (px/frame)
            rotateSpeed: 0.5,     // üîÑ t·ªëc ƒë·ªô xoay (ƒë·ªô / frame)
            tiltAngle: 45,
            leafSize: 80,         // üçÉ K√çCH C·ª† L√Å
            fallAngle: -45         // üçÉ G√ìC R∆†I
        };

        const maiLeaves = [
            "https://raw.githubusercontent.com/ngotranhoangthinhhtk8c-cmd/Dip_tet_nguyen_dan/main/Anh_he_thong/la1.png",
            "https://raw.githubusercontent.com/ngotranhoangthinhhtk8c-cmd/Dip_tet_nguyen_dan/main/Anh_he_thong/la2.png",
            "https://raw.githubusercontent.com/ngotranhoangthinhhtk8c-cmd/Dip_tet_nguyen_dan/main/Anh_he_thong/la3.png",
            "https://raw.githubusercontent.com/ngotranhoangthinhhtk8c-cmd/Dip_tet_nguyen_dan/main/Anh_he_thong/la4.png",
            "https://raw.githubusercontent.com/ngotranhoangthinhhtk8c-cmd/Dip_tet_nguyen_dan/main/Anh_he_thong/la5.png",
            "https://raw.githubusercontent.com/ngotranhoangthinhhtk8c-cmd/Dip_tet_nguyen_dan/main/Anh_he_thong/la6.png",
            "https://raw.githubusercontent.com/ngotranhoangthinhhtk8c-cmd/Dip_tet_nguyen_dan/main/Anh_he_thong/la7.png",
            "https://raw.githubusercontent.com/ngotranhoangthinhhtk8c-cmd/Dip_tet_nguyen_dan/main/Anh_he_thong/la8.png",
            "https://raw.githubusercontent.com/ngotranhoangthinhhtk8c-cmd/Dip_tet_nguyen_dan/main/Anh_he_thong/la9.png"
        ];

        function createLeaf() {
            if (document.querySelectorAll(".leaf").length >= LEAF_CONFIG.maxLeaves) {
                return;
            }

            const leaf = document.createElement("div");
            leaf.className = "leaf";

            leaf.style.width = `${LEAF_CONFIG.leafSize}px`;
            leaf.style.height = `${LEAF_CONFIG.leafSize}px`;

            // üé≤ ch·ªçn ·∫£nh l√° ng·∫´u nhi√™n
            const img = maiLeaves[Math.floor(Math.random() * maiLeaves.length)];
            leaf.style.backgroundImage = `url(${img})`;

            // üéØ x√°c ƒë·ªãnh v√πng r∆°i
            const screenWidth = window.innerWidth;
            const rand = Math.random();

            let startX;

            if (rand < 0.25) {
                // 25% b√™n tr√°i
                startX = Math.random() * screenWidth * 0.25;
            } else if (rand > 0.6) {
                // 40% b√™n ph·∫£i
                startX = screenWidth * 0.6 + Math.random() * screenWidth * 0.4;
            } else {
                // ‚ùå v√πng gi·ªØa kh√¥ng r∆°i
                return;
            }

            let x = startX;
            let y = -50;

            let rotation = 0;

            // üéØ t√≠nh vector r∆°i theo g√≥c
            const angleRad = LEAF_CONFIG.fallAngle * Math.PI / 180;
            const speedX = Math.sin(angleRad) * LEAF_CONFIG.fallSpeed;
            const speedY = Math.cos(angleRad) * LEAF_CONFIG.fallSpeed;

            leaf.style.left = `${startX}px`;
            leaf.style.transform = `rotate(${rotation}deg)`;

            document.body.appendChild(leaf);

            // üå¨Ô∏è animation r∆°i
            function fall() {
                x += speedX;
                y += speedY;
                rotation += LEAF_CONFIG.rotateSpeed;

                leaf.style.left = `${x}px`;
                leaf.style.top = `${y}px`;
                leaf.style.transform = `rotate(${rotation}deg)`;

                if (y < window.innerHeight + 60) {
                    requestAnimationFrame(fall);
                } else {
                    leaf.remove();
                }
            }

            requestAnimationFrame(fall);
        }
    </script>

    <script>
        const progressFill = document.querySelector(".progressFill");
        const progressPercent = document.querySelector(".progressPercent");
        const loadingScreen = document.getElementById("loadingScreen");
        const introScreen = document.getElementById("introScreen");
        const introBox = document.getElementById("introBox");
        const introText = document.getElementById("introText");
        const tapHint = document.getElementById("tapHint");
        const mainText = "t\n."; // intro ƒë·∫ßuq
        const hintText = "kk";
        const music = new Audio("https://raw.githubusercontent.com/tzydangyeu-cmd/Nam_moi_cho_em/main/sounds/bg.mp3");
        let textIndex = 0;
        let hintIndex = 0;
        let introDone = false;

        function typeMainText() {
            if (textIndex < mainText.length) {
                introText.textContent += mainText.charAt(textIndex);
                textIndex++;
                setTimeout(typeMainText, 60);
            } else {
                setTimeout(typeHintText, 500);
            }
        }

        function typeHintText() {
            if (hintIndex < hintText.length) {
                tapHint.textContent += hintText.charAt(hintIndex);
                hintIndex++;
                setTimeout(typeHintText, 80);
            } else {
                introDone = true;
            }
        }

        let introStarted = false;

        function startIntro() {
            if (introStarted) return;
            introStarted = true;
            introScreen.style.display = "flex";
            introText.textContent = "";
            tapHint.textContent = "";
            introBox.style.opacity = 1;
            setTimeout(typeMainText, 800);
        }

        introScreen.addEventListener("click", async () => {
            if (!introDone) return;
            enterFullscreen();
            loadCardImage(); // üëà b·∫Øt ƒë·∫ßu load thi·ªáp sau c√∫ ch·∫°m
            introScreen.style.transition = "opacity 1.5s ease";
            introScreen.style.opacity = 0;
            setTimeout(async () => {
                introScreen.remove();
                loadingScreen.style.display = "flex";
                await initAudio();
                setTimeout(() => {
                    loadingScreen.style.opacity = 0;
                    setTimeout(() => {
                        loadingScreen.remove();
                        document.body.style.background = "#fffde4";

                        // c√†nh ph·∫£i--
                        const branch = document.getElementById("mai-branch");
                        setTimeout(() => {
                            branch.style.opacity = 1;
                            branch.style.transform = "translateX(0)";

                            setTimeout(() => {
                                branch.style.animation = "swayBranch 6s ease-in-out infinite";
                            }, 2000);
                        }, 1500);
                        //end

                        // c√†nh tr√°i --
                        const leftBranch = document.getElementById("mai-left-branch");
                        setTimeout(() => {
                            leftBranch.style.opacity = 1;
                            leftBranch.style.transform = "translateX(0)";

                            setTimeout(() => {
                                leftBranch.style.animation = "swayBranch 6s ease-in-out infinite";
                            }, 2000);
                        }, 1500);
                        // end

                        // t·∫øt
                        const tetText = document.getElementById("tet-text");
                        setTimeout(() => {
                            tetText.style.opacity = 1;
                            tetText.style.transform = "scale(1)";

                            setTimeout(() => {
                                tetText.style.animation = "floatText 6s ease-in-out infinite";
                            }, 2000);
                        }, 1500);
                        // end

                        // 2026
                        const haisauText = document.getElementById("haisau-text");
                        setTimeout(() => {
                            haisauText.style.opacity = 1;
                            haisauText.style.transform = "scale(1)";

                            setTimeout(() => {
                                haisauText.style.animation = "floatText 6s ease-in-out infinite";
                            }, 2500);
                        }, 1500);
                        // end

                        // g√≥c tr√°i d∆∞·ªõi 
                        const gtd = document.getElementById("gtd");
                        setTimeout(() => {
                            gtd.style.opacity = 1;
                            gtd.style.transform = "translateX(0)";

                            setTimeout(() => {
                                gtd.style.animation = "swayBranch 6s ease-in-out infinite";
                            }, 1500);
                        }, 1500);
                        // end

                        // g√≥c ph·∫£i d∆∞·ªõi 
                        const daoBranch = document.getElementById("dao-branch");
                        setTimeout(() => {
                            daoBranch.style.opacity = 1;
                            daoBranch.style.transform = "translateX(0)";

                            setTimeout(() => {
                                daoBranch.style.animation = "swayBranch 6s ease-in-out infinite";
                            }, 2000);
                        }, 1500);
                        // end

                        // b√† v√† c√°c ch√°u
                        const bvcc = document.getElementById("bvcc");
                        setTimeout(() => {
                            bvcc.style.opacity = 1;
                            bvcc.style.transform = "scale(1)";

                            setTimeout(() => {
                                bvcc.style.animation = "floatText 6s ease-in-out infinite";
                            }, 2000);
                        }, 1500);
                        // end

                        // l√¢n
                        const lan = document.getElementById("lan");
                        setTimeout(() => {
                            lan.style.opacity = 1;
                            lan.style.transform = "scale(1)";

                            setTimeout(() => {
                                lan.style.animation = "floatText 6s ease-in-out infinite";
                            }, 3000);
                        }, 1500);
                        // end

                        // l√° mai r∆°i
                        setTimeout(() => {
                            setInterval(createLeaf, 800);
                        }, 2000);
                        // end

                        // thi·ªáp 
                        setTimeout(() => {
                            openCard();
                        }, 2500 + 5000);
                        // end

                        playBG();
                    }, 1200);
                }, 50);
            }, 2500);
        });
    </script>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const isMobile = /Android|iPhone|iPad/i.test(navigator.userAgent);
            if (!isMobile) {
                console.log("PC detected ‚Üí start intro");
                startIntro();
            }
        });
    </script>

    <script>
        function hexToRgb(hex) {
            hex = hex.replace("#", "");
            const bigint = parseInt(hex, 16);
            return {
                r: (bigint >> 16) & 255,
                g: (bigint >> 8) & 255,
                b: bigint & 255
            };
        }
        const fullscreenBtn = document.getElementById('fullscreenBtn');

        function isFullscreen() {
            return document.fullscreenElement !== null;
        }

        function updateFullscreenButton() {
            fullscreenBtn.textContent = isFullscreen()
                ? 'Tho√°t to√†n m√†n h√¨nh'
                : 'To√†n m√†n h√¨nh';
        }

        // B·∫•m n√∫t
        fullscreenBtn.addEventListener('click', () => {
            if (!isFullscreen()) {
                document.documentElement.requestFullscreen().catch(() => { });
            } else {
                document.exitFullscreen();
            }
        });

        // L·∫Øng nghe thay ƒë·ªïi fullscreen (ESC, gesture, v.v.)
        document.addEventListener('fullscreenchange', updateFullscreenButton);

        // C·∫≠p nh·∫≠t l·∫ßn ƒë·∫ßu
        updateFullscreenButton();
    </script>
    <button id="fullscreenBtn" aria-label="Fullscreen">‚õ∂</button>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const btn = document.getElementById('fullscreenBtn');

            function isFullscreen() {
                return document.fullscreenElement ||
                    document.webkitFullscreenElement;
            }

            function requestFS() {
                const el = document.documentElement;
                if (el.requestFullscreen) return el.requestFullscreen();
                if (el.webkitRequestFullscreen) return el.webkitRequestFullscreen();
            }

            function exitFS() {
                if (document.exitFullscreen) return document.exitFullscreen();
                if (document.webkitExitFullscreen) return document.webkitExitFullscreen();
            }

            function updateIcon() {
                btn.textContent = isFullscreen() ? '‚§°' : '‚õ∂';
            }

            btn.addEventListener('click', () => {
                if (!isFullscreen()) {
                    requestFS();
                } else {
                    exitFS();
                }
            });

            document.addEventListener('fullscreenchange', updateIcon);
            document.addEventListener('webkitfullscreenchange', updateIcon);

            updateIcon();
        });
    </script>
    <div id="card-overlay">
        <div id="card-anchor">
            <div id="card">

                <button id="card-close">x</button>

                <div id="card-text-box">
                    <div id="card-text"></div>
                </div>

            </div>
        </div>
    </div>

    <div id="reopen-card-btn">
        <img src="https://raw.githubusercontent.com/ngotranhoangthinhhtk8c-cmd/Dip_tet_nguyen_dan/main/Anh_he_thong/icon_thiep.png"
            alt="M·ªü l·∫°i thi·ªáp" />
    </div>

    <script>
        const wishText = `
T√¥i xin ch√∫c bn th·∫≠t zui zui zui zui zui zui zui zui zui zui zui zui zui zui zui zui zui zui 

zui zui zui zui zui zui zui zui zui zui zui zui zui zui zui zui zui zui zui zui zui zui zui zui zui zui zui zui
üòÜü•πüòóü§°üòµ‚Äçüí´üòµ‚Äçüí´üôÉü•µüòÆ‚Äçüí®üòÆ‚Äçüí®‚ù§Ô∏èüß°üíõüíöü©µüíôüéäüíØüéâüíóüíìüíïüíåüíü‚ô•Ô∏è‚ù§Ô∏è‚Äçü©π‚ù§Ô∏è‚Äçüî•üíãü´Çüë•üë§üë§ü´Üüß†ü´Äü´Åü¶†

        `;

        const overlay = document.getElementById("card-overlay");
        const anchor = document.getElementById("card-anchor");
        const card = document.getElementById("card");
        const cardText = document.getElementById("card-text");
        const closeBtn = document.getElementById("card-close");
        const reopenBtn = document.getElementById("reopen-card-btn");

        let typedIndex = 0;          // ƒë√£ g√µ t·ªõi k√Ω t·ª± n√†o
        let typingRunning = false;  // ƒëang g√µ hay kh√¥ng
        let typingDone = false;     // ƒë√£ g√µ xong to√†n b·ªô ch∆∞a

        reopenBtn.addEventListener("click", () => {
            openCard();
        });


        let cardImageReady = false;

        function loadCardImage() {
            return new Promise((resolve) => {
                if (cardImageReady) {
                    resolve();
                    return;
                }

                const img = new Image();
                img.src = "https://raw.githubusercontent.com/ngotranhoangthinhhtk8c-cmd/Dip_tet_nguyen_dan/main/Anh_he_thong/thiep.png";

                img.onload = () => {
                    card.style.backgroundImage = `url(${img.src})`;
                    cardImageReady = true;
                    resolve();
                };

                img.onerror = () => {
                    console.warn("Kh√¥ng load ƒë∆∞·ª£c ·∫£nh thi·ªáp");
                    resolve();
                };
            });
        }

        function openCard() {
            if (!cardImageReady) return; // ‚õî ch∆∞a load xong th√¨ kh√¥ng m·ªü

            reopenBtn.classList.remove("show");

            overlay.style.opacity = "1";
            overlay.style.pointerEvents = "auto";

            setTimeout(() => {
                anchor.style.opacity = 1;
                anchor.style.transform = "translate(-50%, -50%)";
                card.style.opacity = 1;
                card.style.transform = "translateY(0)"; // ‚≠ê D√íNG C√íN THI·∫æU
            }, 120);

            setTimeout(() => {
                if (!typingDone) {
                    typeText(cardText, wishText, 45);
                }

            }, 800);
        }

        closeBtn.onclick = () => {
            card.style.opacity = 0;
            card.style.transform = "translateY(20px)";
            anchor.style.opacity = 0;
            anchor.style.transform = "translate(-50%, -40%)";

            overlay.style.opacity = "0";
            overlay.style.pointerEvents = "none";

            reopenBtn.classList.add("show");
        };


        function typeText(element, text, speed = 65) {
            if (typingRunning) return; // ‚õî ch·∫∑n ch·∫°y tr√πng
            typingRunning = true;

            const chars = Array.from(text);
            const box = element.parentElement;

            function typing() {
                if (typedIndex >= chars.length) {
                    typingRunning = false;
                    typingDone = true;
                    return;
                }

                const ch = chars[typedIndex];

                if (ch === "\n") {
                    element.appendChild(document.createElement("br"));
                    typedIndex++;
                    typing();
                    return;
                }

                const span = document.createElement("span");
                span.textContent = ch;

                span.style.display = "inline-block";
                span.style.transform = "translateY(6px)";
                span.style.opacity = "0";
                span.style.transition = "transform 0.25s ease, opacity 0.25s ease";

                element.appendChild(span);

                box.scrollTo({
                    top: box.scrollHeight,
                    behavior: "smooth"
                });

                requestAnimationFrame(() => {
                    span.style.transform = "translateY(0)";
                    span.style.opacity = "1";
                });

                typedIndex++;
                setTimeout(typing, speed);
            }

            typing();
        }
    </script>

</body>

</html>